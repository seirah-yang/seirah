# NGS+LLM í”„ë¡œì íŠ¸(ì•ˆ)

ë‹´ë‹¹ì: Seirah
ì„¤ëª…: https://master.bioconductor.org/packages/release/workflows/html/rnaseqGene.html

### í”„ë¡œì íŠ¸ ì •ë³´

**TCGA Meta**ëŠ” ìœ ì „ì²´ + ì„ìƒ ë³€ìˆ˜ + ì˜ˆí›„(outcome) ì •ë³´ë¥¼ í•¨ê»˜ ê°–ì¶˜ ëŒ€í‘œì  ì¢…í•© ì•” ë°ì´í„°ì…‹ìœ¼ë¡œ, í˜ˆì•¡ì¢…ì–‘ ë¶„ì•¼ ë¶„ì„ ë° AI í¬íŠ¸í´ë¦¬ì˜¤ ì œì‘ì— ë§¤ìš° ì í•©í•¨

**â€œLLM ê¸°ë°˜ í™˜ì ìš”ì•½ + ìƒì¡´ ë¶„ì„ (BERT í¬í•¨)â€** í”„ë¡œì íŠ¸ëŠ” ì‹¤ì œ í¬íŠ¸í´ë¦¬ì˜¤ë¡œ ê°•ë ¥í•œ ì‚¬ë¡€ê°€ ë¨

---

### ì•¡ì…˜ ì•„ì´í…œ

- [ ]  
- [ ]  

---

## ğŸ”„â€œTCGA í˜ˆì•¡ì¢…ì–‘ í™˜ìì˜ ìœ ì „ì ë° ì„ìƒ ì •ë³´ë¥¼ í™œìš©í•œ ìƒì¡´ ì˜ˆì¸¡ ë° í™˜ì í”„ë¡œíŒŒì¼ ìš”ì•½â€

- **TCGA (The Cancer Genome Atlas) :** 
ì•” ì—°êµ¬ì—ì„œ ê°€ì¥ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ê³µê³µ ìœ ì „ì²´ ë°ì´í„° í”„ë¡œì íŠ¸ ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. íŠ¹íˆ **ìœ ì „ì²´ ë°ì´í„°ì™€ ì„ìƒ ì •ë³´ë¥¼ í†µí•© ì œê³µ**í•œë‹¤ëŠ” ì ì—ì„œ AI, ë°ì´í„° ë¶„ì„, ë°”ì´ì˜¤ì¸í¬ë§¤í‹±ìŠ¤, ì„ìƒì—°êµ¬ ë¶„ì•¼ ëª¨ë‘ì—ì„œ ì¤‘ìš”í•œ ìì›
    
    ### âœ… ê°œìš”
    
    | í•­ëª© | ì„¤ëª… |
    | --- | --- |
    | ğŸ”¹ ì •ì‹ ëª…ì¹­ | The Cancer Genome Atlas |
    | ğŸ§¬ ëª©ì  | **30ê°œ ì´ìƒì˜ ì•” ìœ í˜•**ì— ëŒ€í•´ ìœ ì „ì²´ ë° ì„ìƒ ì •ë³´ë¥¼ í†µí•©ì ìœ¼ë¡œ ìˆ˜ì§‘í•˜ì—¬, 
    ì•”ì˜ ìƒë¬¼í•™ì  íŠ¹ì„± ë° ì¹˜ë£Œ ë°˜ì‘ì— ëŒ€í•œ ì´í•´ ì¦ì§„ |
    | ğŸ¢ ì£¼ê´€ ê¸°ê´€ | ë¯¸êµ­ êµ­ë¦½ì•”ì—°êµ¬ì†Œ(NCI), êµ­ë¦½ì¸ê°„ê²Œë†ˆì—°êµ¬ì†Œ(NHGRI) |
    | ğŸ“… ê¸°ê°„ | 2006ë…„ ~ 2018ë…„ (ê³µì‹ ì¢…ë£Œ) |
    | ğŸ“Š ê·œëª¨ | 11,000+ ëª…ì˜ í™˜ì ë°ì´í„°, 33ê°œ ì•”ì¢… |
    
    ---
    
    ## âœ… í¬í•¨ëœ ë°ì´í„° ìœ í˜•
    
    TCGAì˜ ê°€ì¥ í° ì¥ì ì€ ë‹¤ì–‘í•œ ë°ì´í„° íƒ€ì…ì´ **ë™ì¼ í™˜ìêµ°ì—ì„œ ìˆ˜ì§‘**ëœë‹¤ëŠ” ì ì…ë‹ˆë‹¤:
    
    | ì¹´í…Œê³ ë¦¬ | ì„¤ëª… |
    | --- | --- |
    | ğŸ§¬ Genomic | - **DNA ì‹œí€€ì‹±**: Germline/Somatic Mutation (MAF)- **Copy Number Variation (CNV)**- **DNA Methylation** |
    | ğŸ”¬ Transcriptomic | - **mRNA Expression** (FPKM, TPM)- **miRNA Expression** |
    | ğŸ§« Proteomic | - Reverse Phase Protein Array (RPPA) |
    | ğŸ©º Clinical | - Age, Gender, Stage, Treatment- **Survival data (OS, PFS ë“±)** |
    | ğŸ§ª Pathology | - H&E Whole Slide Image (WSI) |
    | ğŸ—‚ ê¸°íƒ€ | MSI status, Tumor Purity ë“± |
    
    ---
    
    ## âœ… TCGAì˜ í™œìš© ì˜ˆ
    
    | í™œìš© ë¶„ì•¼ | ì˜ˆì‹œ |
    | --- | --- |
    | ğŸ“ˆ ìƒì¡´ ë¶„ì„ | ìœ ì „ì ë°œí˜„ + ì„ìƒ ë³€ìˆ˜ë¡œ OS/PFS ì˜ˆì¸¡ |
    | ğŸ” ë°”ì´ì˜¤ë§ˆì»¤ ë°œêµ´ | íŠ¹ì • ìœ ì „ì ë³€ì´ì™€ ì˜ˆí›„/ë°˜ì‘ ê°„ì˜ ìƒê´€ê´€ê³„ ë¶„ì„ |
    | ğŸ§  ë¨¸ì‹ ëŸ¬ë‹ | ë¶„ë¥˜ (ì˜ˆ: ì¢…ì–‘ ì•„í˜•), ì˜ˆì¸¡ (ì¹˜ë£Œ ë°˜ì‘), ì„¤ëª… (ìƒ˜í”Œë³„ SHAP ë“±) |
    | ğŸ§¬ ë‹¤ì¤‘ ì˜¤ë¯¹ìŠ¤ í†µí•© | CNV + Expression + Methylation ë™ì‹œ ë¶„ì„ |
    | ğŸ¨ ë³‘ë¦¬/ì˜ìƒ ë¶„ì„ | Whole Slide Image ê¸°ë°˜ CNN/Transformer ë¶„ì„ (via TCGA-BRCA ë“±) |
    
    ---
    
    ## âœ… ë°ì´í„° ì ‘ê·¼ ê²½ë¡œ
    
    | í”Œë«í¼ | ì„¤ëª… |
    | --- | --- |
    | UCSC Xena | ë‹¤ìš´ë¡œë“œ ë° Pandas í˜¸í™˜ ê°€ëŠ¥ |
    | GDC Data Portal | ì›ë³¸ BAM/VCF íŒŒì¼ í¬í•¨ |
    | [cbioPortal](https://www.cbioportal.org/) | ì„ìƒ/ìœ ì „ì ì •ë³´ Web ê¸°ë°˜ ì‹œê°í™” |
    | TCGAbiolinks (R) | R ê¸°ë°˜ì˜ ê³ ê¸‰ ì „ì²˜ë¦¬ íˆ´ |
    | [xenaPython](https://github.com/ucscXena/XenaPython) | Python ê¸°ë°˜ ì ‘ê·¼ ì˜ˆì œ ì œê³µ |
    
    ---
    
    ## âœ… í˜ˆì•¡ì¢…ì–‘ ê´€ë ¨ ì•”ì¢… ì˜ˆì‹œ (ì‚¬ìš©ì ë°°ê²½ê³¼ ì—°ê²°)
    
    | TCGA ì•”ì¢… ì½”ë“œ | ì„¤ëª… |
    | --- | --- |
    | **LAML** | Acute Myeloid Leukemia (AML) |
    | **DLBC** | Diffuse Large B-cell Lymphoma |
    | **UVM** | Uveal Melanoma |
    | **SKCM** | Melanoma (í‘ìƒ‰ì¢…, ì¼ë¶€ í˜ˆì•¡í•™ì  ì—°ê´€ ê°€ëŠ¥) |
    
    ---
    
    ## âœ… TCGAì˜ ì¥ì  ìš”ì•½
    
    | í•­ëª© | ì„¤ëª… |
    | --- | --- |
    | âœ… ë‹¤ì¤‘ ì˜¤ë¯¹ìŠ¤ | ìœ ì „ì, ë‹¨ë°±ì§ˆ, ë³€ì´ ë“± ë‹¤ì¤‘ ê³„ì¸µ ì œê³µ |
    | âœ… ê³µê°œ ë° í‘œì¤€í™” | ëˆ„êµ¬ë‚˜ ì‚¬ìš© ê°€ëŠ¥, ì½”ë“œí™”/ì •ê·œí™” ì™„ë¹„ |
    | âœ… ì„ìƒ ë°ì´í„° í¬í•¨ | ìƒì¡´ì¼ìˆ˜, ë³‘ê¸°, ì¹˜ë£Œ ì •ë³´ ì¡´ì¬ |
    | âœ… ëª¨ë¸ í•™ìŠµ ì í•© | AI-ready: ë¨¸ì‹ ëŸ¬ë‹/ë”¥ëŸ¬ë‹ ëª¨ë¸ í•™ìŠµì— ìš©ì´ |
    
    ---
    
    ## ğŸ“š ì°¸ê³  ìë£Œ ë° ë…¼ë¬¸
    
    1. **TCGA Marker ë…¼ë¬¸ (Pan-cancer ë¶„ì„)**
        
        https://www.cell.com/fulltext/S0092-8674(18)30178-6
        
    2. **GDC ê³µì‹ ì†Œê°œ**
        
        https://gdc.cancer.gov/about-data/publications/pancanatlas
        
    3. **Python Tutorial ì˜ˆì œ (UCSC Xena ê¸°ë°˜)**
        
        [https://github.com/ucscXena/XenaPython](https://github.com/ucscXena/XenaPython)
        
    
    ---
    
    ## âœ… ë§ˆë¬´ë¦¬ ìš”ì•½
    
    | í•­ëª© | ë‚´ìš© |
    | --- | --- |
    | ğŸ§¬ TCGAëŠ” **ìœ ì „ì²´ + ì„ìƒ + ìƒì¡´ ë°ì´í„°**ë¥¼ í†µí•©í•œ ì¢…ì–‘ ë¹…ë°ì´í„° ìì‚°ì…ë‹ˆë‹¤. |  |
    | ğŸ› ï¸ ë‹¤ì–‘í•œ AI ê¸°ë²•(Transformer, LLM, ìƒì¡´ ë¶„ì„ ëª¨ë¸)ì— ì§ì ‘ ì ìš© ê°€ëŠ¥ |  |
    | ğŸ’¡ íŠ¹íˆ í˜ˆì•¡ì•” ë°ì´í„°(LAML ë“±)ëŠ” **ì„ìƒ + ë°œí˜„ + ë³€ì´** ì „ë¶€ í¬í•¨ë˜ì–´ ìˆì–´, í¬íŠ¸í´ë¦¬ì˜¤ ê³¼ì œì— ìµœì ì…ë‹ˆë‹¤. |  |
    
    ---
    
    í•„ìš”í•˜ì‹œë©´:
    
    - TCGA LAML ì‹¤ìŠµìš© CSV ì •ë¦¬ë³¸
    - Survival ëª¨ë¸ êµ¬í˜„ ì˜ˆì œ
    - GPTë¡œ ì„ìƒ ë°ì´í„° ìš”ì•½í•˜ëŠ” í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿

## âœ… ì „ì²´ êµ¬ì„± ìš”ì•½

| **êµ¬ì„± ìš”ì†Œ** | **ì‚¬ìš© ë„êµ¬** |
| --- | --- |
| **ğŸ“Š ë°ì´í„° ë¡œë”©/ì „ì²˜ë¦¬** | **pandas, numpy,** UCSC Xena (LAML ë“±) |
| **ğŸ”¬ ìƒì¡´ ë¶„ì„** | PySurvival or lifelines, **BERT** (ClinicalBERT or TabBERT) |
| **âœ¨ ìš”ì•½ ìƒì„±** | **OpenAI GPT (with LangChain)**, Prompt Engineering |
| **ğŸ“ˆ ì‹œê°í™”** | seaborn, plotly, Kaplanâ€“Meier plot (pycox í¬í•¨ ê°€ëŠ¥) |

---

## âœ… 1ë‹¨ê³„. ë°ì´í„° ìˆ˜ì§‘ ë° ì „ì²˜ë¦¬

### ğŸ“Œ ë°ì´í„° ì†ŒìŠ¤

- [UCSC Xena](https://xenabrowser.net/datapages/) > TCGA > [LAML (Acute Myeloid Leukemia)](https://xenabrowser.net/datapages/?cohort=TCGA%20Acute%20Myeloid%20Leukemia%20(LAML)&removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443)
    - `clinicalMatrix`
    - `HTSeq - FPKM`
    - `Survival data`

### ğŸ“Œ ì „ì²˜ë¦¬ ì‘ì—…

- ìƒì¡´ì¼ìˆ˜, ìƒíƒœ(Censored vs Dead) ìƒì„±
- ìœ ì „ì ë°œí˜„ ë°ì´í„°: z-score or top variance ê¸°ë°˜ ì„ íƒ
- í•„ìˆ˜ ì„ìƒ ë³€ìˆ˜: Age, Gender, Race, Stage ë“±

```python
import pandas as pd

clinical = pd.read_csv("LAML_clinical.csv")
expression = pd.read_csv("LAML_expression.csv")
survival = pd.read_csv("LAML_survival.csv")

# ìƒì¡´ì •ë³´ merge
data = clinical.merge(survival, on="sample_id")
data['event'] = data['vital_status'].apply(lambda x: 1 if x == 'Dead' else 0)
data['time'] = data['days_to_death'].fillna(data['days_to_last_followup'])
```

---

### âœ… 2ë‹¨ê³„. ìƒì¡´ ì˜ˆì¸¡ ëª¨ë¸ êµ¬ì¶• (Tabular BERT ì‚¬ìš© í¬í•¨)

https://colab.research.google.com/drive/1L_TXAd6gdZ6-pdS1oWxsJdVR6pRb8Pgb#scrollTo=lJwXj6FDxiG1 : NGS) TCGA Data_ AMLí˜ˆì•¡ì¢…ì–‘í™˜ìì˜ ìœ ì „ì ë° ì„ìƒì •ë³´ë¥¼ í™œìš©í•œ ìƒì¡´ ì˜ˆì¸¡

### ë°©ë²• 1: **PySurvival / lifelines + LightGBM**

- ê¸°ë³¸ ëª¨ë¸: CoxPH, Weibull, GradientBoostingSurvivalAnalysis

### ë°©ë²• 2: **TabBERT / ClinicalBERT**

- [TabTransformer](https://arxiv.org/abs/2012.06678), [TabBERT](https://arxiv.org/abs/2204.12833)
- ClinicalBERT í™œìš© ì‹œ: `transformers` + `scikit-survival`

```python
from lifelines import CoxPHFitter
from lifelines.utils import concordance_index

cph = CoxPHFitter()
cph.fit(data[['time', 'event', 'age', 'stage', 'TP53_expression']], duration_col='time', event_col='event')
cph.print_summary()
```

- ClinicalBERT ì˜ˆì‹œëŠ” HuggingFaceì—ì„œ `emilyalsentzer/Bio_ClinicalBERT` ì‚¬ìš©

---

### âœ… 3ë‹¨ê³„. Kaplanâ€“Meier ì‹œê°í™”

```python
from lifelines import KaplanMeierFitter
import matplotlib.pyplot as plt

kmf = KaplanMeierFitter()
kmf.fit(data['time'], event_observed=data['event'])
kmf.plot_survival_function()
plt.title('Kaplan-Meier: ì „ì²´ ìƒì¡´ ê³¡ì„ ')
```

---

âœ… 4ë‹¨ê³„. LLM ê¸°ë°˜ í™˜ì í”„ë¡œíŒŒì¼ ìš”ì•½ [(LangChain + OpenAI API)](https://wikidocs.net/book/14021)

### ğŸ“Œ ì˜ˆì‹œ Prompt

```
You are a clinical assistant. Please summarize the patientâ€™s oncological profile:
INPUT:
- Age: 67
- Gender: Male
- TP53 expression: High
- FLT3 mutation: Present
- Stage: III
- Overall survival: 152 days

OUTPUT (Korean):
ì´ í™˜ìëŠ” 67ì„¸ ë‚¨ì„±ìœ¼ë¡œ, TP53 ìœ ì „ì ê³¼ë°œí˜„ ë° FLT3 ëŒì—°ë³€ì´ë¥¼ ë³´ì´ë©°, ë³‘ê¸° IIIì— í•´ë‹¹í•©ë‹ˆë‹¤. ì „ì²´ ìƒì¡´ ê¸°ê°„ì€ ì•½ 5ê°œì›”ì…ë‹ˆë‹¤.
```

### ğŸ“¦ LangChain ì˜ˆì œ ì½”ë“œ

```python
from langchain.chat_models import ChatOpenAI
from langchain.prompts import PromptTemplate
from langchain.chains import LLMChain

prompt_template = PromptTemplate(
    input_variables=["age", "gender", "gene", "stage", "survival"],
    template="í™˜ìëŠ” {age}ì„¸ {gender}ì…ë‹ˆë‹¤. {gene} ìœ ì „ì íŠ¹ì„±ì„ ê°€ì§€ë©°, ë³‘ê¸° {stage}ì…ë‹ˆë‹¤. ì˜ˆì¸¡ëœ ìƒì¡´ ê¸°ê°„ì€ {survival}ì¼ì…ë‹ˆë‹¤. ìš”ì•½í•´ ì£¼ì„¸ìš”."
)

llm = ChatOpenAI(temperature=0.1, model="gpt-4")
chain = LLMChain(llm=llm, prompt=prompt_template)

result = chain.run({
    "age": 67,
    "gender": "ë‚¨ì„±",
    "gene": "TP53 ê³¼ë°œí˜„, FLT3 ëŒì—°ë³€ì´",
    "stage": "III",
    "survival": 152
})
print(result)
```

---

### âœ… 5ë‹¨ê³„. ì‹œê°í™” ë° ëŒ€ì‹œë³´ë“œí™”

- `plotly.express` ë˜ëŠ” `seaborn`ìœ¼ë¡œ ì˜ˆì¸¡ ê²°ê³¼ ë¹„êµ
- Streamlit ë˜ëŠ” Jupyter ê¸°ë°˜ ëŒ€ì‹œë³´ë“œí™” ì¶”ì²œ

---

## âœ… ê²°ê³¼ ì˜ˆì‹œ êµ¬ì„±

| í•­ëª© | ì˜ˆì‹œ |
| --- | --- |
| ğŸ“ˆ ìƒì¡´ê³¡ì„  | Kaplanâ€“Meier plot / Stage ë³„ êµ¬ë¶„ |
| ğŸ§  BERT ëª¨ë¸ | ClinicalBERT ê¸°ë°˜ ìƒì¡´ë¶„ë¥˜ ì •í™•ë„ |
| âœ¨ ìš”ì•½ ê²°ê³¼ | LLM ê¸°ë°˜ ìš”ì•½ ë¬¸ì¥ ì¶œë ¥ |
| ğŸ“Š í™˜ì ì‚¬ë¡€ ìš”ì•½ | Streamlitì—ì„œ í™˜ì ì„ íƒ â†’ í”„ë¡œíŒŒì¼ ìë™ ìš”ì•½ í‘œì‹œ |

---

## ğŸ“š ì°¸ê³  ìë£Œ

| ìœ í˜• | ë§í¬ |
| --- | --- |
| TCGA + Python ì˜ˆì œ | [UCSC Xena Python Tutorial](https://github.com/ucscXena/XenaPython) |
| BERT in Survival | [BERTSurv (ë…¼ë¬¸)](https://arxiv.org/abs/2301.02506) |
| LLM ì„ìƒ ìš”ì•½ | [Clinical GPT Prompt Guide (Stanford)](https://github.com/stanford-crfm/helm) |
| LangChain ê³µì‹ ë¬¸ì„œ | LangChain Docs |

---

![ [https://biopython.org/](https://biopython.org/)Â ](2726fcfd-db78-4fc0-bb18-895a9e71b3e2.png)

 [https://biopython.org/](https://biopython.org/)Â 

Biopythonì€ ìƒë¬¼ ì •ë³´í•™(bioinformatics)ì„ ìœ„í•œ Python ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ, ìƒë¬¼í•™ì  ë°ì´í„°ë¥¼ ë¶„ì„í•˜ê³  ì²˜ë¦¬í•˜ëŠ” ë° ì‚¬ìš© 

**DNA, RNA, ë‹¨ë°±ì§ˆ ì‹œí€€ìŠ¤ì™€ ê°™ì€ ìƒë¬¼í•™ì  ë°ì´í„°**ë¥¼ ë‹¤ë£¨ëŠ” ì—°êµ¬ìë“¤ì—ê²Œ ìœ ìš©í•œ ë„êµ¬ë¥¼ ì œê³µí•˜ë©°, **ì‹œí€€ìŠ¤ ë¶„ì„, 3D êµ¬ì¡° ë¶„ì„, ìœ ì „ì²´ ë¶„ì„ ë“± ë‹¤ì–‘í•œ ìƒë¬¼ ì •ë³´í•™ì  ì‘ì—…ì„ ì§€ì›í•¨.**

1.  **ì‹œí€€ìŠ¤ ì²˜ë¦¬**: DNA, RNA, ë‹¨ë°±ì§ˆ ì‹œí€€ìŠ¤ì˜ ì…ì¶œë ¥, ì²˜ë¦¬ ë° ë¶„ì„ì„ ìœ„í•œ ê¸°ëŠ¥ì„ ì œê³µ. ì„œë¡œ ë‹¤ë¥¸ ì‹œí€€ìŠ¤ í˜•ì‹ ê°„ì˜ ë³€í™˜, ì‹œí€€ìŠ¤ ì¡°ì‘ ë° ë¶„ì„ ë“±ì„ ì‰½ê²Œ ìˆ˜í–‰ ê°€ëŠ¥

1. **íŒŒì¼ í˜•ì‹ ì§€ì›**: FASTA, GenBank, SwissProt ë“±ê³¼ ê°™ì€ ë‹¤ì–‘í•œ ìƒë¬¼í•™ì  ë°ì´í„° í˜•ì‹ì„ ì½ê³  ì“¸ ìˆ˜ ìˆë‹¤.
2. **ë°ì´í„°ë² ì´ìŠ¤ ì•¡ì„¸ìŠ¤**: NCBI, ExPASy ë“± ì£¼ìš” ìƒë¬¼ ì •ë³´í•™ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•˜ê³  ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆëŠ” ë„êµ¬ë¥¼ ì œê³µ
3. **3D êµ¬ì¡° ë¶„ì„**: PDB íŒŒì¼ í˜•ì‹ì„ íŒŒì‹±í•˜ì—¬ ë‹¨ë°±ì§ˆì˜ 3D êµ¬ì¡°ë¥¼ ë¶„ì„í•˜ê³  ì‹œê°í™”í•  ìˆ˜ ìˆë‹¤.
4. **ìœ ì „ì²´ ë¶„ì„**: BLASTì™€ ê°™ì€ ìœ ì „ì²´ ë¶„ì„ ë„êµ¬ì™€ì˜ í†µí•©ì„ í†µí•´, ìœ ì „ì²´ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ê³  ë¹„êµ
    
    cf. DNA ì‹œí€€ìŠ¤ì˜ GC í•¨ëŸ‰(Guanine-Cytosine content)
    
    ìƒë¬¼ ì •ë³´í•™ ë¶„ì•¼ì—ì„œ ì—°êµ¬ì™€ êµìœ¡ì„ ì´‰ì§„í•˜ë©°, ìƒë¬¼í•™ì  ë°ì´í„°ì˜ ì´í•´ë¥¼ ê¹Šê²Œ í•˜ëŠ” ë° ê¸°ì—¬
    

---

## ğŸ“Œ ë‹¤ìŒ ë‹¨ê³„

- ì „ì²´ ì‹¤ìŠµìš© **Colab Notebook í‹€ ì œì‘**
- BERT ìƒì¡´ ë¶„ì„ êµ¬ì¡° â†’ Custom Layerë¡œ ë³€í˜•
- LangChain ìš”ì•½ Prompt ê°œì„  ì˜ˆì œ
- í¬íŠ¸í´ë¦¬ì˜¤ PDF or GitHub README í…œí”Œë¦¿
    
    ì§„í–‰ ì›í•˜ì‹œëŠ” í•­ëª©(ì˜ˆ: Colab, README ë“±) ì œì‹œí•˜ì—¬ êµ¬ì„± ìš”ì²­ 
    

---

## **í”„ë¡œì íŠ¸ ì•ˆ 1)** LLM + Tabular IE ê¸°ë°˜ **PFS/OS ìƒì¡´ ì˜ˆì¸¡ ë° ìš”ì•½**

### ğŸ“Œ ì£¼ì œ

**â€œí˜ˆì•¡ì¢…ì–‘ í™˜ìì˜ ìœ ì „ì/ì„ìƒì •ë³´ ê¸°ë°˜ ìƒì¡´ ì˜ˆì¸¡ ë° ì„ìƒ ìš”ì•½ ìë™í™”â€**

### ğŸ¯ ëª©ì 

- TCGAì—ì„œ í˜ˆì•¡ì•”(BLCA, LAML ë“±) í™˜ìêµ°ì„ ì„ íƒí•˜ì—¬
    
    â†’ ìœ ì „ì ë°œí˜„/ì„ìƒë³€ìˆ˜ ê¸°ë°˜ **Progression-Free Survival(PFS), Overall Survival(OS)** ì˜ˆì¸¡
    
    â†’ LLM ê¸°ë°˜ í™˜ì ìš”ì•½ ìë™í™” (e.g., "65ì„¸ ë‚¨ì„±, TP53 ëŒì—°ë³€ì´, PFS 2ê°œì›”")
    

---

### ğŸ“‚ ì‚¬ìš© ë°ì´í„°

| í•­ëª© | ë‚´ìš© |
| --- | --- |
| ğŸ“Š Clinical | ë‚˜ì´, ì„±ë³„, ë³‘ê¸°, ì¹˜ë£Œ ë°˜ì‘, ìƒì¡´ê¸°ê°„ ë“± |
| ğŸ§¬ Genomic | mRNA expression (FPKM/TPM), mutation matrix (MAF), copy number |
| ğŸ§« í˜ˆì•¡ì•” subset | LAML (ê¸‰ì„± ê³¨ìˆ˜ì„± ë°±í˜ˆë³‘), DLBC (Diffuse large B-cell lymphoma) |

### ğŸ”— ë°ì´í„° ìœ„ì¹˜

- TCGA via GDC Data Portal
- Python ë¼ì´ë¸ŒëŸ¬ë¦¬: `TCGAbiolinks` (R ê¸°ë°˜) / UCSC Xena
- Precompiled: https://xena.ucsc.edu

---

### ğŸ” ë¶„ì„ íë¦„

1. **ì „ì²˜ë¦¬**:
    - ìƒì¡´ì •ë³´(OS, PFS), censoring ì²˜ë¦¬
    - ìœ ì „ì ë°œí˜„: Variance ë†’ì€ top Në§Œ ì¶”ì¶œ
    - ì„ìƒ ë³€ìˆ˜: ë‚˜ì´, ë³‘ê¸° ë“± ì •ë¦¬
2. **ëª¨ë¸ êµ¬ì„±**:
    - Survival Model: CoxPH / DeepSurv / Transformer ê¸°ë°˜ ìƒì¡´ ëª¨ë¸
    - Feature Selection: ìœ ì˜í•œ ì„ìƒ/ìœ ì „ë³€ìˆ˜ë§Œ ì…ë ¥
3. **LLM + IE ìš”ì•½**:
    - í™˜ì í”„ë¡œíŒŒì¼ (JSON/CSV) â†’ GPT ê¸°ë°˜ ìì—°ì–´ ìš”ì•½
    - ì˜ˆ: `"This is a 67-year-old male with TP53 mutation and stage III disease. Estimated OS: 14 months"`

---

### ğŸ“š ê´€ë ¨ ë…¼ë¬¸

1. **Deep learning-based survival prediction for cancer patients using multi-omics data**
    
    [https://www.nature.com/articles/s41598-020-58028-0](https://www.nature.com/articles/s41598-020-58028-0)
    
    â†’ TCGA ê¸°ë°˜ ìƒì¡´ ì˜ˆì¸¡, Multi-modal data ì‚¬ìš©
    
2. **Clinical BERT: Modeling Clinical Notes and Predicting Hospital Readmission**
    
    [https://arxiv.org/abs/1904.05342](https://arxiv.org/abs/1904.05342)
    
    â†’ LLMì„ ì´ìš©í•œ ì„ìƒ ìš”ì•½/ì˜ˆì¸¡ ì‚¬ë¡€
    

---

## **í”„ë¡œì íŠ¸ ì•ˆ2)** ë³€ì´ ê¸°ë°˜ LLM ìš”ì•½ + Subtype ë¶„ë¥˜

### ğŸ“Œ ì£¼ì œ

**â€œí˜ˆì•¡ì•” í™˜ì ë³€ì´ ì •ë³´ ê¸°ë°˜ LLM ìš”ì•½ ë° ì•„í˜• ë¶„ë¥˜ ëª¨ë¸ ê°œë°œâ€**

### ğŸ¯ ëª©ì 

- TCGA ë³€ì´ ì •ë³´(MAF íŒŒì¼)ë¥¼ ê¸°ë°˜ìœ¼ë¡œ
    
    â†’ í™˜ìë³„ ìš”ì•½(LLM ê¸°ë°˜)
    
    â†’ íŠ¹ì • ì•„í˜•/subtype ë¶„ë¥˜ (ì˜ˆ: M0 vs M5 AML ë“±)
    

---

### ğŸ“‚ ì‚¬ìš© ë°ì´í„°

| í•­ëª© | ë‚´ìš© |
| --- | --- |
| ë³€ì´ ì •ë³´ | MAF format (gene, position, type ë“±) |
| ë³‘ê¸°, ì•„í˜• | LAML subtype, stage ë“± |
| ì„ìƒ | ì¢…ì–‘ ë“±ê¸‰, ì¹˜ë£Œ ë°˜ì‘ ë“± |

---

### ğŸ” ë¶„ì„ íë¦„

1. **MAF íŒŒì¼ ì „ì²˜ë¦¬**:
    - í•„í„°ë§ (PASS, Coding region, Nonsynonymous)
    - í™˜ìë³„ Mutation Summary ìƒì„±
2. **LLM ê¸°ë°˜ ìš”ì•½**:
    - ì˜ˆ: `"Patient harbors FLT3-ITD, NPM1 mutations, associated with poor prognosis"`
3. **ë¶„ë¥˜ ëª¨ë¸**:
    - Transformer / XGBoost â†’ ì•„í˜• ì˜ˆì¸¡

---

### ğŸ“š ê´€ë ¨ ë…¼ë¬¸

1. **Mutational landscape and significance of molecular classification in AML**
    
    [https://www.nature.com/articles/nrc.2017.60](https://www.nature.com/articles/nrc.2017.60)
    
    â†’ AML ë³€ì´ ê¸°ë°˜ ë¶„ë¥˜ì˜ ì˜ì˜ ì •ë¦¬
    
2. **MAF-to-Text: Mutation summaries from VCF/MAF using LLMs**
    
    (ê´€ë ¨ ë…¼ë¬¸ì€ ì—†ìœ¼ë‚˜ Prompt ê¸°ë°˜ ì •ë¦¬ ê°€ëŠ¥. í•„ìš” ì‹œ í”„ë¡¬í”„íŠ¸ ì˜ˆì‹œ ë“œë¦´ê²Œìš”)
    

---

## ğŸ”§ ê¸°ìˆ  ìŠ¤íƒ ì œì•ˆ

| ë¶„ì•¼ | ë„êµ¬ |
| --- | --- |
| ìƒì¡´ ë¶„ì„ | `lifelines`, `scikit-survival`, `DeepSurv`, `PySurvival` |
| ìœ ì „ì²´ ì „ì²˜ë¦¬ | `pandas`, `numpy`, `maftools`, `xenaPython` |
| LLM ìš”ì•½ | OpenAI API, LangChain, Prompt Engineering |
| ì‹œê°í™” | `seaborn`, `plotly`, `pycox`, Kaplanâ€“Meier plot |

### âœ… ë‹¤ìŒ ë‹¨ê³„ ì¶”ì²œ

- ë‘ í”„ë¡œì íŠ¸ ì¤‘ ê´€ì‹¬ ìˆëŠ” ë°©í–¥(ì˜ˆì¸¡ vs ìš”ì•½ vs subtype ë¶„ë¥˜)ì„ ì„ íƒí•˜ì‹œë©´
    
    â†’ **Colab ê¸°ë°˜ ìŠ¤ì¼ˆë ˆí†¤ ì½”ë“œ**
    
    â†’ **ì˜ˆì œ ë°ì´í„°ì…‹ ë¡œë”© ì½”ë“œ**
    
    â†’ **ëª¨ë¸ ì„¤ê³„ ì œì•ˆ (BERT/Survival/LangChain)**
    

---

**2. Gene expression ë°ì´í„° ë‹¤ìš´ë°›ê¸°**

`ì°¸ê³  ë¸”ë¡œê·¸ : https://blog.naver.com/PostView.nhn?blogId=combioai&logNo=221320056674`

TCGAbiolinksì˜ ìì„¸í•œ ì‚¬ìš©ë²•ì€ Documents ([https://bioconductor.org/packages/release/bioc/html/TCGAbiolinks.html](https://bioconductor.org/packages/release/bioc/html/TCGAbiolinks.html))ë¥¼ ì°¸ê³ í•˜ë„ë¡ í•˜ì. ë³¸ í¬ìŠ¤íŠ¸ì—ì„œëŠ” Gene Expression (GE) ë°ì´í„°ë¥¼ ë‹¤ìš´ë°›ëŠ” ë°©ë²•ì„ ê°„ë‹¨íˆ ì†Œê°œí•œë‹¤.

cf. https://bioconductor.org/packages/release/bioc/html/TCGAbiolinks.html

**1) GDC í¬íƒˆì—ì„œ ë°ì´í„° íƒìƒ‰**

ì–´ë–¤ ë°ì´í„°, ì–´ë–¤ íƒ€ì…, ì–´ë–¤ í¬ë§·ì˜ ë°ì´í„°ë¥¼ ë‹¤ìš´ë°›ì„ ê²ƒì¸ì§€ë¥¼ GDC ë°ì´í„° í¬íƒˆì— ë‚˜íƒ€ë‚œ ì˜µì…˜ë“¤ì„ ê°€ì§€ê³  ê²°ì •í•´ì•¼í•œë‹¤. GDC ë°ì´í„° í¬íƒˆì—ì„œ Repositoryì— ê°€ë©´ ê·¸ë¦¼2ì™€ ê°™ì´ íŒŒì¼ ì˜µì…˜ë“¤ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤.

ê° íŒŒì¼ ì˜µì…˜ì— ëŒ€í•œ ì„¤ëª…ì€ GDC Documents ([https://docs.gdc.cancer.gov/](https://docs.gdc.cancer.gov/))ë¥¼ ì°¸ê³ í•œë‹¤.

**2) TCGAbiolinkë¡œ ë°ì´í„° ë‹¤ìš´ë°›ê¸°**

ë³¸ ì˜ˆì œì—ì„œëŠ” ê°„ì•”(TCGA-LIHC)ì˜ GE ë°ì´í„°ë¥¼ read count í¬ë§·ìœ¼ë¡œ ë‹¤ìš´ë°›ëŠ”ë‹¤. ì•„ë˜ì™€ ê°™ì´ 1)ì—ì„œ ì°¾ì€ íŒŒì¼ ì˜µì…˜ë“¤ì„ GDCquery í•¨ìˆ˜ì— ì…ë ¥í•˜ê³ , GDCdownloadë¥¼ í˜¸ì¶œí•˜ë©´ ì‘ì—… ê³µê°„ì— íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

**3) ë°ì´í„° ì¢…í•©í•˜ê¸°**

GDCì˜ GE ë°ì´í„°ëŠ” ìƒ˜í”Œë³„ë¡œ ë¶„ë¦¬ë˜ì–´ìˆë‹¤. ì´ë“¤ì„ í•˜ë‚˜ì˜ íŒŒì¼(ì—´:ìƒ˜í”Œ, í–‰:ìœ ì „ì)ë¡œ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” GDCprepareí•¨ìˆ˜ë¥¼ í†µí•´ ì „ì²˜ë¦¬ë¥¼ ì§„í–‰í•˜ë©´ ëœë‹¤. ê·¸ë¦¬ê³  matrix í¬ë§·ìœ¼ë¡œ ë§Œë“¤ê¸° ìœ„í•´ TCGAbiolinksì™€ ê°™ì´ ì„¤ì¹˜ëœ SummarizedExperiment ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•œë‹¤.